name: top
class: center, middle, top-background

<h1 style="line-height:1.5em; font-size:6rem;">.en[Gopher] ã¨è¡Œã .en[Lang] ãªæ—…</h1>

<br/>

.title-img[![gopher](images/gophercolor.png)]

<p class="h2 en">Go Conference 2019 Spring</p> <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãƒ»ã‚³ãƒ¢ãƒ³ã‚ºãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
</a>
<br />

<small>ã“ã‚Œã¯ <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãƒ»ã‚³ãƒ¢ãƒ³ã‚º è¡¨ç¤º 4.0 å›½éš› ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</a>ã®ä¸‹ã«æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚</small>

---

## <span class="en">Introduction</span>

.left-split[
#### <span class="en">Profile</span>

```bash
 name       Ryo Terunuma
 handlename YooWaan
                 `-- Game / Twitter / Qiita
 company    BrainPad
                 `-- p å¤§æ–‡å­—
 role       Engineering Manager
```

#### <span class="en">Details</span>

```bash
$ Infra | Backend | Front
$ Member | TeamLead | Manager
```

#### <span class="en">Develop   </span>


```bash
$ Platform System
```

]

.right-split[

<a href="https://www.brainpad.co.jp/" target="_blank">
<img src="images/brainpad.png" width="90%"/>
</a>
]

---
class: center, middle

.big[
å…ˆã«  
ã„ã¤ã‚‚ã®  
ãŠç´„æŸ
]

---
class: middle


.text-center[
## ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚’å‹Ÿé›†ã—ã¦ã„ã¾ã™
]

<p class="strong">
  <span class="badge badge-pill badge-warning align-middle">ğŸ¤“ Data Engineer</span>
  <span class="badge badge-pill badge-primary align-middle">â›‘ Site Reliability Engineer</span>
  <span class="badge badge-pill badge-light">Application Engineer</span>
</p>

.text-center[
ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™

å¿…ãšæ¡ç”¨æ‹…å½“ã¾ã§ã¯,ãŠç¹‹ãã—ã¾ã™
]

---
class: center, middle

.big[
ä»Šæ—¥ã®ãŠè©±
]

.title-img[
![gopher](images/gophercolor.png)
]

---
class: middle

.display-2[
.text-center[
- ã©ã†æ›¸ã„ãŸã‚‰ã„ã„ã®ã‹ï¼Ÿ
- ã©ã‚“ãªè¨€èªãªã®ã‹ï¼Ÿ
]
]

<div class="row justify-content-center mb-4">
  <div class="col-md-5 text-center" >
  <p class="bubble display-2" style="width:420px;">ä¸å®‰ã‚’è§£æ±º</p>
 </div>
</div>
<div class="row justify-content-center">
<img alt="gopher" src="images/gophercolor.png" width="10%" height="10%"/>
</div>

---
class: center, middle

## <span class="en">Beginner</span> å‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ãªã‚Šã¾ã™


<p class="strong">
 <span class="badge badge-pill badge-primary"> â˜… </span> <span class="text-primary">Junior / Beginner</span>
</p>

.display-2[
<span class="badge badge-pill badge-light"> ğŸ˜° </span> Senior (ä¸­ç´šè€…)

<span class="badge badge-pill badge-light"> ğŸ˜± </span> Expert (ä¸Šç´šè€…)
]

---
class: center, middle, eye-bg

.strong[
ãªã®ã§ã€é æ…®ãªãé€”ä¸­ã§

**è³ªå•** or **ä½•ã‹èããŸã„** ã¨ã‹

å¤§ä¸ˆå¤«ã§ã™
]

---
class: center, middle

# Junior / Beginner

.display-4[
<br>

å®Œå…¨ãªåˆå¿ƒè€…ã‚’æƒ³å®šã—ã¦ã„ã¾ã›ã‚“

ãªã‚“ã‚‰ã‹ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³)ã‚’

æ›¸ã„ãŸã“ã¨ãŒã‚ã‚‹äº‹ã‚’

æƒ³å®šã—ã¦ã„ã¾ã™
]

---
class: center, middle, eye-bg

.strong[
æ—…

è¨­å®šã§ã™
]

(è¬)

---

# ğŸ“œ æ¦‚è¦

.display-4[
1. æ—…ç«‹ã¡ ç·¨
   - Gopher <i class="icon-go"></i> ã¨æº–å‚™ã¨æ—…ç«‹ã¡
2. Golang ãªæ—… ç·¨
   - Twelve Go Best Practices ã®ç´¹ä»‹
3. Lang ãªæ—… ç·¨
   - ã„ã‚ã‚“ãªè¨€èªã§æ¥½ã—ã‚€ <span class="bg-warning small">&dagger;</span> <span class="en">(Ruby / Python / Java / Javascript / C#)</span>
4. éå»ã® Trend ãªæ—… ç·¨
   - ä»Šã¾ã§ã‚ã£ãŸãƒˆãƒ¬ãƒ³ãƒ‰åæ‰€å·¡ã‚Š <span class="bg-warning small">&dagger;</span> <span class="en">(Linq / ReactiveX)</span>
5. We are one peace ï¼ˆã¾ã¨ã‚ <span class="small">æ—…ã®çµ‚ã‚ã‚Š</span>ï¼‰
]

<span class="bg-warning small">&dagger;</span>ï¼ˆç­†è€…ã®ä¸»è¦³ï¼‰

---
class: center, middle

.big[
æ—…ç«‹ã¡ç·¨
]

---
class: center, eye-bg

.big[
ã¾ãš

Gopher ã«ä¼šã†
]


---

## <i class="icon-go"></i> Golang ã¨ã¯


* expressive ... è¡¨ç¾ãŒè±Šã‹ã§
* concise ... ç°¡æ½”ã§
* clean ... ã‚­ãƒ¬ã‚¤ã§
* efficient ... ç„¡é§„ãŒãªã„(åŠ¹ç‡ãŒã„ã„)

<br/>

.text-center[
<img src="images/what-is-golang.png" width="60%"/>
]
---

## Golang ã¨ã¯

.history-text[
<table class="table">
  <tr>
  <td>
	<i class="icon-python text-success"></i><br/>
	<i class="icon-java-duke"></i>
  </td>
  <td class="align-middle"><i class="icon-ruby text-danger"></i></td>
  <td class="align-middle"><i class="icon-javascript-alt" style="color:gold;"></i></td>
  <td></td>
  <td class="align-middle"><i class="icon-csharp text-success"></i></td>
  <td></td>
  <td></td>
  <td class="align-middle"><i class="icon-go text-info"></i></td>

  <td class="align-middle"><img class="history-img"src="https://upload.wikimedia.org/wikipedia/commons/b/b5/Kotlin-logo.png"/></td>
  <td class="align-middle"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9d/Swift_logo.svg/40px-Swift_logo.svg.png"/></td>
  <td></td>
  </tr>
<tr class="en">
<td>1991</td>
<td>1993</td>
<td>1994</td>
<td>1995</td>
<td>2002</td>
<td>2006</td>
<td>2007</td>
<td>2009</td>
<td>2011</td>
<td>2014</td>
<td></td>
</tr>
  <tr>
  <td></td>
  <td></td>
  <td><img class="history-img" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Sega-Saturn-Console-Set-Mk1.jpg/1920px-Sega-Saturn-Console-Set-Mk1.jpg"  /></td>
  <td><img class="history-img" src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/95/PSX-Console-wController.png/280px-PSX-Console-wController.png"/></td>
  <td>3G</td>
  <td><img class="history-img" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d3/PS3Versions.png/250px-PS3Versions.png"/></td>
  <td>iPhone</td>
  <td></td>
  <td>4G</td>
  <td></td>
  <td></td>
  </tr>
</table>

]

å‚è€ƒãƒªãƒ³ã‚¯

<small>
[ãƒ—ãƒ­ã‚°ãƒ©ãƒ å¹´è¡¨ wikipediaã‚ˆã‚Š](https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E8%A8%80%E8%AA%9E%E5%B9%B4%E8%A1%A8)
,[1G - 5G](https://bridgera.com/5g-promises-new-horizons-for-iot/)
</small>


???
https://dmitri.shuralyov.com/idiomatic-go


---
class: eye-bg

## æ—…ç«‹ã¡ã®ä¸å®‰

.display-2[

.text-center[
Golang ? Gopher ?

ã©ã‚“ãªè¨€èªãªã®ã‹ï¼Ÿ

ã©ã†æ›¸ã„ãŸã‚‰ã„ã„ã®ã‹ï¼Ÿ
]

]

<div class="row justify-content-center text-center">
  <div class="col-md-9 offset-md-3 text-center" >
  <p class="bubble display-2" style="width:64%;">ä¸å®‰ãªéƒ¨åˆ†ã‚’è§£æ±º</p>
 </div>
</div>

---
class: center, middle


<div class="h3 border-success rounded bg-info text-light pt-3 pb-3">
<b>ä¸å®‰ã®ãƒ¢ãƒˆã¯ä½•ã‹ï¼Ÿ</b>
</div>

---
## ãƒ¢ãƒˆã‚’æ¢ã‚‹

.display-3[
ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãŒã‚„ã‚ŠãŸã„ã“ã¨

- ã‚‚ã®ã‚’ä½œã‚ŠãŸã„
- æŠ€æ³•ã‚’é©åˆ‡ã«åˆ©ç”¨ã—ãŸã„
- ãƒ¢ãƒãƒ™ãƒ»å“²å­¦ãƒ»æ€æƒ³ã‚’åæ˜ ã—ãŸã„
]

---
## ãƒ¢ãƒˆã«ã‚ã‚‹ä¸å®‰è¦ç´ 

.display-4[
- ã‚‚ã®ã‚’ä½œã‚ŠãŸã„
> â†’ å®Ÿè£…ã§ãã‚‹ã‹ï¼Ÿ
- æŠ€æ³•ã‚’é©åˆ‡ã«åˆ©ç”¨ã—ãŸã„
> â†’ æŠ€æ³•ã®é©ç”¨ã§ãã‚‹ã‹ï¼Ÿ  
> â†’ Seniorã€Expert ã®å¨å…‰ï¼ˆãƒã‚¦ãƒ³ãƒ†ã‚£ãƒ³ã‚°ï¼‰
- ãƒ¢ãƒãƒ™ãƒ»å“²å­¦ãƒ»æ€æƒ³ã‚’åæ˜ ã—ãŸã„
> â†’ ã„ã¾ã¾ã§ã®çµŒé¨“ã¯ã©ã†ãªã‚‹ï¼Ÿ  
> â†’ æ–°ã—ã„æ…£ç¿’ã£ã¦ãªã‚“ã ã‚ï¼Ÿ
]

---
## æ—…ã‚’é€šã˜ã¦æ„Ÿã˜ã¦ã„ãäº‹


.h1[
Golang <i class="icon-go"></i> ã® .bg-info[Simplicity] (å˜ç´”ãƒ»ç°¡å˜)
]


.h2[
<br/>

* ã‚‚ã®ã‚’ä½œã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’åºƒã’ã‚‹ã€€ â†’ Twelve Go Best Practices
* æŠ€æ³•ã®ä½¿ã„æ‰€ã‚’å°‘ã—åºƒã‚ã‚‹
* ãƒ¢ãƒãƒ™ãƒ»å“²å­¦ãƒ»æ€æƒ³ã®æ•´ç†ã€€ã€€ â†’ å„è¨€èª / Trend
]

.text-right[
<a class="badge badge-pill badge-info" href="https://talks.golang.org/2015/simplicity-is-complicated.slide#1" target="_blank">
Simplicity is Complicated <i class="inline-b material-icons" style="display: inline-flex; vertical-align: middle;">exit_to_app</i>
</a>

<small>by Rob Pike</small>
]


???

è©³ç´°ã¯Pike ã•ã‚“ã®ã‚‚ã®ã‚’å‚ç…§ãã ã•ã„

---
class: center, middle

.big[
.en[Golang] ãªæ—…

.en[Twelve Go Bestpractice]
]

.title-img[![gopher](images/gophercolor.png)]

---

## Twelve Best Practice ?


.left-split[
.text-center[
<img src="images/bestpractice-about.png" width="90%"/>  
Developer Advocate for the Go team at Google and for Google Cloud Platform
]
]
.right-split[
.text-center[
<img src="images/talk-bestpractice.png" width="90%" />

Go talks 2013

]
.text-right[
<a class="badge badge-pill badge-info" href="https://talks.golang.org/"> Go Talks <i class="fa fa-arrow-right"></i></a>
]
]


---

# BestPractices ã®ç´¹ä»‹


1. Avoid nesting by handling errors first
2. Avoid repetition when possible
3. Important code goes first
4. Document your code
5. Shorter is better
6. Packages with multiple files
7. Make your packages "go get"-able
8. Ask for what you need
9. Keep independent packages independent
10. Avoid concurrency in your API
11. Use goroutines to manage state
12. Avoid goroutine leaks
]

<a class="badge badge-pill badge-info" href="https://talks.golang.org/2013/bestpractices.slide#1" target="_blank">
Twelve Go Best Practices <i class="inline-b material-icons" style="display: inline-flex; vertical-align: middle;">exit_to_app</i>
</a>


---

## Twelve Go Best Practices

Golangã®æ›¸ãæ–¹ã®ã‚¨ãƒƒã‚»ãƒ³ã‚¹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†


```bash
 Beginner ã¯ã“ã“ã‹ã‚‰
1. Avoid nesting by handling errors first
2. Avoid repetition when possible
3. Important code goes first
4. Document your code
```

```bash
 ä¸­ç´šã«å‘ã‘ã¦
5. Shorter is better
6. Packages with multiple files
7. Make your packages "go get"-able
8. Ask for what you need
9. Keep independent packages independent
```

ä»Šæ—¥ã¯ã“ã“ã¾ã§

```bash
 ä¸­ç´šä»¥ä¸Šã®ãŠè©±
10. Avoid concurrency in your API
11. Use goroutines to manage state
12. Avoid goroutine leaks
```

---

## Some code

```golang
type Gopher struct {
    Name     string
    AgeYears int
}
```

```go
func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) {
    err = binary.Write(w, binary.LittleEndian, int32(len(g.Name)))
    if err == nil {
        size += 4
        var n int
        // bad
        n, err = w.Write([]byte(g.Name))
        size += int64(n)
        if err == nil {
            // bad
            err = binary.Write(w, binary.LittleEndian, int64(g.AgeYears))
            if err == nil {
                size += 4
            }
            return
        }
        return
    }
    return
}
```


---

## 1. Avoid nesting by handling errors first

ãƒã‚¹ãƒˆã‚’å›é¿ã—ã¦ã€ï¼‘ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã§ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ«ã‚’ã™ã‚‹

```golang
func (g *Gopher) WriteTo(w io.Writer) (size int64, err error) {
    err = binary.Write(w, binary.LittleEndian, int32(len(g.Name)))
    if err != nil {
        return
    }
    size += 4
    n, err := w.Write([]byte(g.Name))
    size += int64(n)
    if err != nil {
        return
    }
    err = binary.Write(w, binary.LittleEndian, int64(g.AgeYears))
    if err == nil {
        size += 4
    }
    return
}
```

---

## 2. Avoid repetition when possible

```golang
type binWriter struct {
    w    io.Writer
    size int64
    err  error
}

func (w *binWriter) Write(v interface{}) {
    if w.err != nil {
        return
    }
    if w.err = binary.Write(w.w, binary.LittleEndian, v); w.err == nil {
        w.size += int64(binary.Size(v))
    }
}
```

ãƒã‚¤ãƒŠãƒªã®Writerã‚’ä½œã£ã¦ãã‚Œã‚’å†åˆ©ç”¨ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã

```golang
func (g *Gopher) WriteTo(w io.Writer) (int64, error) {
    bw := &binWriter{w: w}
    bw.Write(int32(len(g.Name)))
    bw.Write([]byte(g.Name))
    bw.Write(int64(g.AgeYears))
    return bw.size, bw.err
}
```

---

## 3. Important code goes first

ãƒ©ã‚¤ã‚»ãƒ³ã‚¹æƒ…å ±ã€ãƒ“ãƒ«ãƒ‰ã‚¿ã‚°(Build Tags)ã€package ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ  
import æ–‡ã‚’é–¢ä¿‚ã™ã‚‹ã‚°ãƒ«ãƒ¼ãƒ—æ¯ã« blank line ã§åˆ†ã‘ã¾ã—ã‚‡ã†

```golang
import (
    "fmt"
    "io"
    "log"

    "golang.org/x/net/websocket"
)
```

é‡è¦ãª type ã‹ã‚‰å§‹ã‚ã¦ã€æœ€å¾Œã®æ–¹ã«è£œåŠ©çš„ãª func, type ã‚’è¨˜è¿°ã™ã‚‹

```go
type FistData struct { /* some thing */}

func Func1() {}
func Func2() {}

type subData struct {}

```

---
## 4. Document your code

ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã®å‰ã«å†…å®¹ã‚’æ›¸ãã¾ã—ã‚‡ã†  
<span class="text-muted">Package name, with the associated documentation before. </span>

```golang
// Package playground registers an HTTP handler at "/compile" that
// proxies requests to the golang.org playground service.
package playground
```

å¤–éƒ¨å…¬é–‹ã™ã‚‹ã‚‚ã®ã¯ã€ã¡ã‚ƒã‚“ã¨æ›¸ãã¾ã—ã‚‡ã†  
<span class="text-muted">Exported identifiers appear in godoc, they should be documented correctly.</span>

```golang
// Author represents the person who wrote and/or is presenting the document.
type Author struct {
    Elem []Elem
}

// TextElem returns the first text elements of the author details.
// This is used to display the author' name, job title, and company
// without the contact details.
func (p *Author) TextElem() (elems []Elem) {
```

<a class="badge badge-pill badge-info" href="https://blog.golang.org/godoc-documenting-go-code" target="_blank"> Godoc: documenting code <i class="fa fa-arrow-right"></i></a>

---

## 5. Shorter is better

é•·ã„åå‰ã¯ã„ã„ã¨ã¯é™ã‚‰ãªã„ã‚ˆ  
<span class="text-muted">or at least longer is not always better.</span>

è‡ªæ˜ãªçŸ­ã„åå‰ã‚’ä»˜ã‘ã¾ã—ã‚‡ã†  
<span class="text-muted">Try to find the shortest name that is self explanatory</span>

*  **MarshalWithIndentation** ã‚ˆã‚Š **MarshalIndent** ãŒå¥½ã¾ã—ã„

packageåã¯ import ã‚’è¡Œã£ãŸå´ã§ prefix ã¨ã—ã¦åˆ©ç”¨ã—ã¾ã™  
<span class="text-muted">Don't forget that the package name will appear before the identifier you chose. </span>

```golang
pacakge json

var (
    JSONEncoder = someThing{} // bad
    Encoder = someThing{}     // good
)
```

```golang
import "json"

json.JSONEncoder.foo() // bad
json.Encoder.foo()     // good

```

---

## 6. Packages with multiple files

* é•·ã„ï¼ˆå¤§ãã„ï¼‰ãƒ•ã‚¡ã‚¤ãƒ«ã¯é¿ã‘ã‚‹
* code ã¨ testcode ã¯åˆ†ã‘ã‚‹ ï¼ˆtest code ã¯ãƒ†ã‚¹ãƒˆã®æ™‚ã®ã¿ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¾ã™ï¼‰
* package ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯åˆ†ã‘ã‚‹

.text-center[
    <i class="icon-go text-primary" aria-hidden="true"></i> package ãŒå¤§ãããªã‚‹ã‚ˆã†ãªã‚‰ doc.go ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›¸ãäº‹ã¨ã„ã„ã§ã™
    <br/><br/>
    <img src="images/http-pkg.png" width="50%">
]


???

httpãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ãã®ã‚ˆã†ãªå½¢ã‚’ã¨ã£ã¦ã„ã¾ã™

---

## Make your packages "go get"-able

<code class="remark-inline-code inline-b">"go get"</code> å¯èƒ½ãªå˜ä½ã§packageã‚’ä½œæˆã—ã¾ã—ã‚‡ã†

* ã‚³ãƒãƒ³ãƒ‰ç­‰ã¯å†åˆ©ç”¨ã§ããªã„ã‚‚ã®ã‚‚ã‚ã‚‹
* å†åˆ©ç”¨å¯èƒ½ãªã‚‚ã®ã¯ãã®å˜ä½

.left-split[

```bash
  cmd/
    xxxget/
    xxxmount/
    xxxput/
```
]

.right-split[
```bash
  auth/
    auth.go
  blobref/
    blobref.go
    blobref_test.go
    chanpeek.go
    fetcher.go
```
]

---

## 8. Ask for what you need

```golang
type Gopher struct {
    Name     string
    AgeYears int
}
```

```golang
// 1. method å®šç¾©ãŒã§ãã¾ã™
func (g *Gopher) WriteToFile(f *os.File) (int64, error) {

// 2. å…·ä½“çš„ãªå‹ã¯ãƒ†ã‚¹ãƒˆã—ã«ãã„ã®ã§ã€Interfaceã‚’åˆ©ç”¨ã™ã‚‹
func (g *Gopher) WriteToReadWriter(rw io.ReadWriter) (int64, error) {

// 3. é–¢æ•°ã§å¿…è¦ãªã“ã¨ã«ã‚’æ¤œè¨ã™ã‚‹ io.ReaderWriter â†’ io.Writer
func (g *Gopher) WriteToWriter(f io.Writer) (int64, error) {
```

Ã— ãƒ•ã‚¡ã‚¤ãƒ«ã¸æ›¸ãè¾¼ã¿ãŸã„

ã€€ã€€â†“â†“â†“

â—¯ æƒ…å ±ã‚’æ›¸ãè¾¼ã¿ãŸã„

---

## 9. Keep independent packages independent

```golang
import (
    "golang.org/x/talks/2013/bestpractices/funcdraw/drawer"
    "golang.org/x/talks/2013/bestpractices/funcdraw/parser"
)
```

```golang
    // Parse the text into an executable function.
    f, err := parser.Parse(text)
    if err != nil {
        log.Fatalf("parse %q: %v", text, err)
    }

    // Create an image plotting the function.
    m := drawer.Draw(f, *width, *height, *xmin, *xmax)

    // Encode the image into the standard output.
    err = png.Encode(os.Stdout, m)
    if err != nil {
        log.Fatalf("encode image: %v", err)
    }
```

---

## ãã®ä»–ã®Tips


.display-4[
10ï¼ Avoid concurrency in your API  
11ï¼ Use goroutines to manage state  
12ï¼ Avoid goroutine leaks

ä»Šå›ã¯å‰²æ„›ã—ã¾ã™
]


---

## <span class="bg-info">å°ã¾ã¨ã‚</span>


.left-split[

Gopher ã¨ä»²è‰¯ããªã‚‹ç‚ºã«

1. ãƒã‚¹ãƒˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ«ã‚’ã—ãªã„
2. ç¹°ã‚Šè¿”ã—ã‚’é¿ã‘ã‚‹
3. é‡è¦ãªã‚³ãƒ¼ãƒ‰ã‹ã‚‰æ›¸ã„ã¦ã„ã
4. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›¸ã
5. çŸ­ã„åå‰ã¯è‰¯ã„
6. ãƒ•ã‚¡ã‚¤ãƒ«ã¯å°ã•ã
7. go get å¯èƒ½ã«ã™ã‚‹
8. ä½•ãŒå¿…è¦ãªã®ã‹ã‚’é‡è¦è¦–ã™ã‚‹
9. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç‹¬ç«‹æ€§ã‚’ä¿ã¤
]

.right-split[


_.en[Golang] <i class="icon-go"></i> åˆã‚ã¦ã®æ–¹ã¯ ã“ã¡ã‚‰ã‹ã‚‰_


æœ€åˆã«è¦‹ã‚‹ã¨

* [Goè¨€èªã®åˆå¿ƒè€…ãŒè¦‹ã‚‹ã¨å¹¸ã›ã«ãªã‚Œã‚‹å ´æ‰€](https://qiita.com/tenntenn/items/0e33a4959250d1a55045)

ãã®ä»–æ°—ã‚’ã¤ã‘ã‚‹äº‹

* [CodeReviewComments](https://github.com/golang/go/wiki/CodeReviewComments)
* [æ—¥æœ¬èªç¿»è¨³](https://qiita.com/knsh14/items/8b73b31822c109d4c497)



ä¸Šæ‰‹ã«ã‹ã‘ã‚‹ç‚ºã«

* [Effective Go](https://golang.org/doc/effective_go.html)


ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸å‚åŠ ã—ãŸã„äººã¯

* [Community Code of Conduct](https://golang.org/conduct)

]

---
class: center, middle

.display-1[
.en[Lang] ãªæ—…
]
.display-3[
ã„ã‚ã‚“ãªè¨€èªã§æ¥½ã—ã‚€
]

.title-img[![gopher](images/gophercolor.png)]


---
class: eye-bg

## ã„ã‚ã‚“ãªè¨€èªã®æ—…

.h1[.lh16[
* <i class="icon-java-duke"></i> <i class="icon-python text-success"></i> (<i class="icon-ruby text-danger"></i> <i class="icon-csharp text-success"></i>)Class(ã‚¯ãƒ©ã‚¹) ã®ç¶™æ‰¿
* <i class="icon-ruby text-danger"></i> Ruby block variable
* <i class="icon-javascript-alt" style="color:gold;"></i> <i class="icon-csharp text-success"></i> async, await
* <i class="icon-java-duke"></i>  annotation, <i class="icon-python text-success"></i> decorator
* <i class="icon-java-duke"></i> interface, <i class="icon-python text-success"></i> duck typing
]]

---

## ã„ã‚ã‚“ãªè¨€èªã®æ—…

.h1[.lh16[
* <i class="icon-java-duke"></i> <i class="icon-python text-success"></i> Class(ã‚¯ãƒ©ã‚¹) ã®ç¶™æ‰¿
]]

---
## <i class="icon-java-duke"></i> <i class="icon-python text-success"></i> Class(ã‚¯ãƒ©ã‚¹) ã®ç¶™æ‰¿

<div class="text-center mermaid">
graph LR;
    Child-- ç¶™æ‰¿ -->Parent;

</div>


.left-split[

```java
// Java
class Parent {
    public void say() { System.out.println("parent"); }
}

class Child extends Parent {
    public void say() { System.out.println("child"); }
}
```

<button class="btn btn-raised" onclick="player.open('/src/clz.java', '/src/clz.py');">Eval</button>

]

.right-split[
```python
// python
class Parent:

    def say(self):
        print('parent')

class Child(Parent):

    def say(self):
        print('child')
```
]


---
## <i class="icon-go"></i> Class(ã‚¯ãƒ©ã‚¹) Example

```golang
package main

type Parent struct {}
func (p Parent) say() string {return "parent" }
func (p Parent) Print() { println(p.say())}
func (p Parent) Hello() { println(p.say())}

type Child struct { Parent }
func (c Child) say() string {return "child" }
// Print() ã¯ Parent ã®å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹
func (c Child) Hello() { println(c.say()) }

```

<button class="btn btn-raised" onclick="player.open('/src/clz.go');">Eval</button>


child ã® Hello() ã¯ "child" ã¨å‡ºåŠ›ã™ã‚‹ãŒã€Print() ã¯ "parent" ã¨å‡ºåŠ›ã—ã¾ã™

---
## <i class="icon-go"></i> Class(ã‚¯ãƒ©ã‚¹) Summary


[Effectiive Go#Embedding](https://golang.org/doc/effective_go.html#embedding)

Go does not provide the typical, type-driven notion of subclassing, ...

Golang ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚’æä¾›ã—ã¦ã„ãªã„ã®ã§ã€interface ã‚’å®šç¾©ã—ã¦ãã‚Œã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’ç´¹ä»‹ã—ã¦ã¾ã™


```golang
type Say interface {
	Print()
}

type Person struct {
	Say
}

type sayParent struct {}
func (p *sayParent) Print() { println("parent") }

type sayChild struct {}
func (p *sayChild) Print() { println("child") }

```

<button class="btn btn-raised" onclick="player.open('/src/clz_summary.go');">Eval</button>


---

## ã„ã‚ã‚“ãªè¨€èªã®æ—…

.h3[.lh16[
.text-muted[
* <i class="icon-java-duke"></i> <i class="icon-python text-success"></i> Class(ã‚¯ãƒ©ã‚¹) ã®ç¶™æ‰¿
]]]

.h1[
* <i class="icon-ruby text-danger"></i> Ruby block variable
]


---
## <i class="icon-ruby text-danger"></i> Ruby block variable

```ruby
[1, 2, 3].each do |i|
    put i*2
end
```

.text-right[
<a class="badge badge-pill badge-info" href="http://docs.ruby-doc.com/docs/ProgrammingRuby/html/intro.html#S6" target="_blank">docs: Blocks and Iterators <i class="fa fa-arrow-right"></i></a>
]

```ruby
class List
  def initialize(arr)
    @arr = arr
  end
  def each
    i = 0
    while i < @arr.length
      yield @arr[i]
      i += 1
    end
  end
end
```

<button class="btn btn-raised" onclick="player.open('/src/blockvar.rb');">Eval</button>

---
## <i class="icon-go"></i> Ruby block variable: Example

```golang
type Person struct {
    Name string
}

type People []Person

func (pp People) Each(hfn func(i int, p Person)) {
  for i, p := range pp {
     hfn(i, p)
  }
}

func main() {
   people := People{ Person{"tom"}, Person{"bom"} }

   names := []string{}
   people.Each(func(i int, p Person) {
       names = append(names, p.Name)
   })
   println(strings.Join(names, ","))
}
```

<button class="btn btn-raised" onclick="player.open('/src/blockvar.go');">Eval</button>

---
## <i class="icon-go"></i> Ruby block variable: Summary


<span class="bg-info h1">Golang</span>

* ä¸‹ã®ã‚ˆã†ã«è¨˜è¿°å¯èƒ½ã§ãƒ–ãƒ­ãƒƒã‚¯å¤‰æ•°ã¨ã„ã†ã‚ˆã†ãªæ¦‚å¿µã¯ä¸è¦

```go
for _, num := range []int{1, 2, 3}{
   // Do something
}
```

---

## ã„ã‚ã‚“ãªè¨€èªã®æ—…

.h3[.lh16[

.text-muted[
* <i class="icon-java-duke"></i> <i class="icon-python text-success"></i> Class(ã‚¯ãƒ©ã‚¹) ã®ç¶™æ‰¿
* <i class="icon-ruby text-danger"></i> Ruby block variable
]]]

.h1[
* <i class="icon-javascript-alt" style="color:gold;"></i> <i class="icon-csharp text-success"></i> async, await
]

---
## <i class="icon-javascript-alt" style="color:gold;"></i> <i class="icon-csharp text-success"></i> async, await


<i class="icon-javascript-alt display-4" style="color:gold;"></i> ã® async/await

- async : éåŒæœŸå‡¦ç†é–¢æ•°ã‚’å®šç¾©ã™ã‚‹ <a class="badge badge-pill badge-info" href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Statements/async_function" target="_blank">async <i class="fa fa-external-link-alt"></i></a>
- await : Promiseã®resolve, reject ã®çµæœã‚’å¾…ã¤  
awaitã¯asyncã®é–¢æ•°å†…ã§ã—ã‹ä½¿ãˆãªã„ <a class="badge badge-pill badge-info" href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Operators/await" target="_blank">async <i class="fa fa-external-link-alt"></i></a>


<i class="icon-csharp text-success display-4"></i> ã® async/await

- async <a class="badge badge-pill badge-info" href="https://docs.microsoft.com/ja-jp/dotnet/csharp/language-reference/keywords/async" target="_blank"> async <i class="fa fa-external-link-alt"></i></a> Task, Task<TResult> ã‚’è¿”ã™éåŒæœŸãƒ¡ã‚½ãƒƒãƒ‰
- await <a class="badge badge-pill badge-info" href="https://docs.microsoft.com/ja-jp/dotnet/csharp/language-reference/keywords/await" target="_blank"> await  <i class="fa fa-external-link-alt"></i></a> éåŒæœŸå‡¦ç†(Task, Task<TResult>, ValueTask, ValueTask<TResult>)ã‚’å¾…ã¤


---

## <i class="icon-javascript-alt" style="color:gold;"></i> <i class="icon-csharp text-success"></i> async, await éåŒæœŸå‡¦ç†


.left-split[

```js
function wait(waitSec) {
  return new Promise(resolve => {
    setTimeout(_ => {
      resolve(`resolved:${waitSec}`);
    }, waitSec);
  });
}

async function awaitNumsWait(nums) {
  while ( (num = nums.shift()) !== undefined ) {
    const result = await wait(num);
    console.log(`await [${result}]`);
  }
}

async function asyncNumsWait(nums) {
  Promise.all(nums.map(n => {
    return wait(n);
  })).then(values => {
	return console.log('asyncDone::' +values.join(','));
  });
}
```
]

.right-split[
```js
async function awaitAndAsyncCall(nums) {
  asyncNumsWait(nums);
  awaitNumsWait(nums);
  return 'awaitAndAsyncCall::done';
}

const nums = [2000, 1000, 1500];
awaitAndAsyncCall(nums).then((msg) => {
  console.log(msg);
});
```

<button class="btn btn-raised" onclick="player.open('/src/async_await.js');">Eval</button>
]



---

## async, await éåŒæœŸå‡¦ç†


<div class="text-center mermaid">
sequenceDiagram
    Process ->> AsyncLogic: éåŒæœŸå‡¦ç†
    AsyncLogic ->> BackendLogic1: ä½•ã‹ã®å‡¦ç†
    AsyncLogic ->> BackendLogic2: ä½•ã‹ã®å‡¦ç†
    Process ->> Process: ä»–ã®å‡¦ç†
    Note right of Process: éåŒæœŸå‡¦ç†ã‚’å¾…ãŸãªã‘ã‚Œã°ã€ãƒ—ãƒ­ã‚»ã‚¹ã¯çµ‚ã‚ã‚‹
</div>


---
## <i class="icon-go"></i> async, await: Example

.left-split[

```golang
func asyncFunc(sleep time.Duration, start time.Time) {
	time.Sleep(sleep)
	elapsed("async", start)
}

func awaitFunc(wg *sync.WaitGroup, sleep time.Duration, start time.Time) {
	defer wg.Done()
	// do somethig
	time.Sleep(sleep)
	elapsed("await", start)
}

```
]


.right-split[

```golang
func main() {
	start := time.Now()
	nums := []time.Duration{ 2 * time.Second, time.Second, 1500 * time.Millisecond }

	// async finished
	for _, sec := range nums {
		go asyncFunc(sec, start)
	}

	// await
	await := new(sync.WaitGroup)
	for _, sec := range nums {
		await.Add(1)
		go awaitFunc(await, sec, start)
	}
	await.Wait()

	println("finish")
}
```

<button class="btn btn-raised" onclick="player.open('/src/async_await.go');">Eval</button>

]



---
## <i class="icon-go"></i> async, await: Summary


<span class="bg-info h1">async</span>

* go routine ã§å®Ÿè¡Œã™ã‚Œã°å¤§ä¸ˆå¤«
* å¾…ãŸãªã„ã¨ãã®ã¾ã¾ãƒ—ãƒ­ã‚»ã‚¹ãŒçµ‚ã‚ã‚Šã¾ã™

<span class="bg-info h1">await</span>

* æ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã® WaitGroup ã‚’åˆ©ç”¨ã™ã‚Œã°å¤§ä¸ˆå¤«
* 1ã¤ã®å‡¦ç†ãªã‚‰å˜ç´”ã«é–¢æ•°ã‚’ãã®ã¾ã¾å‘¼ã¶


---

## ã„ã‚ã‚“ãªè¨€èªã®æ—…

.h3[
.lh16[
.text-muted[
* <i class="icon-java-duke"></i> <i class="icon-python text-success"></i> Class(ã‚¯ãƒ©ã‚¹) ã®ç¶™æ‰¿
* <i class="icon-ruby text-danger"></i> Ruby block variable
* <i class="icon-javascript-alt" style="color:gold;"></i> <i class="icon-csharp text-success"></i> async, await
]]]

.h1[
* <i class="icon-java-duke"></i>  annotation, <i class="icon-python text-success"></i> decorator
]

---
## <i class="icon-java-duke"></i>  annotation, <i class="icon-python text-success"></i> decorator

.left-split[
```java
import java.lang.annotation.ElementType;
import java.lang.annotation.Target;

@Target(ElementType.METHOD) // ãƒ¡ã‚½ãƒƒãƒ‰ã«ã—ã‹ä»˜ã‘ã‚‰ã‚Œã¾ã›ã‚“
public @interface Option {
    boolean isActive() default false;
}

class Api {

  @Option(isActive = true)
  public void get() String {
     return "get";
  }

  @Option
  public void put() String {
     return "put";
  }
}
```
]

.right-split[

```python
def api_option(fn):
    def func_wrapper():
        return "wrap[{0}]".format(fn())
    return func_wrapper

@api_option
def say():
    return 'say'

def hello():
    ''' no decrated function '''
    return 'hello'
```

<button class="btn btn-raised" onclick="player.open('/src/annotation.java','/src/decorator.py');">Eval</button>

]

---
## <i class="icon-java-duke"></i>  annotation

<div class="text-center mermaid">
graph LR;
	start((Start)) --> cb[Call API];
	cb --> ann{Annotation?}
	ann --> |yes| do[Related Annotation logic]
	ann --> |no| no[not work]
	do --> fin((End));
	no --> fin((End));

    style start fill:#2cb5e8;
    style fin fill:#2cb5e8;
</div>

```java
class Caller {
    public void call(Object instance, String methodName) {
        try {
            Method method = instance.getClass().getMethod(methodName);
            Option option = method.getAnnotation(Option.class);
            String result = option.isActive()
                ? String.format("warp[%s]", method.invoke(instance))
                : method.invoke(instance).toString();

            System.out.println("Result[" + result + "]");
        } catch (Throwable cause) {
            throw new RuntimeException(cause);
        }
    }
}
```


---
## <i class="icon-python text-success"></i> decorator


<div class="text-center mermaid">
graph LR;
	start((Start)) --> cb[Call API];
	cb --> wrap[Run wrapped code];
	wrap --> fn[Run original function code];
	fn --> fin((End));

    style start fill:#2cb5e8;
    style fin fill:#2cb5e8;
</div>

```python
def api_option(fn):
    def func_wrapper():
        return "wrap[{0}]".format(fn())
    return func_wrapper

@api_option
def say():
    return 'say'
```


---
## <i class="icon-go"></i>  anotation, decorator: Example


```golang
// api function
type ApiFunc func() string

// function adpter
func ApiOption(fn ApiFunc, isActive bool) ApiFunc {
  if isActive {
    return func() string {
       return fmt.Sprintf("wrap [%s]", fn())
    }
  }
  return fn  
}

func Get() string { return "get" }

type Api struct {
    Get ApiFuc `option:"active=true"`
    Put ApiFuc `option:"active=false"`
}


```

<button class="btn btn-raised" onclick="player.open('/src/decopartor_annotation.go');">Eval</button>


---
## <i class="icon-go"></i>  anotation, decorator: Summary

<span class="bg-info h1">annotation</span>

* struct tag ã§æŒ¯ã‚‹èˆã„ã‚’å¤‰æ›´ã§ãã‚‹
* â€» ä¾‹ã¯è‰¯ããªã„ã®ã§å¿˜ã‚Œã¦ãã ã•ã„  
  encoding/json ã¨ã‹ã‚’å‚ç…§ãã ã•ã„

```go
type Person struct {
    Id       int    `json:"id"` `db:"id"`
    Name     string `json:"name"` `db:"name"`
    Age      int `json:"age"` `db:"age"`
}
```


<span class="bg-info h1">decorator</span>

* Function Adapterã§å¤§ä¸ˆå¤«

---

## ã„ã‚ã‚“ãªè¨€èªã®æ—…

.h3[
.lh16[
.text-muted[
* <i class="icon-java-duke"></i> <i class="icon-python text-success"></i> Class(ã‚¯ãƒ©ã‚¹) ã®ç¶™æ‰¿
* <i class="icon-ruby text-danger"></i> Ruby block variable
* <i class="icon-javascript-alt" style="color:gold;"></i> <i class="icon-csharp text-success"></i> async, await
* <i class="icon-java-duke"></i>  annotation, <i class="icon-python text-success"></i> decorator
]]]

.h1[
* <i class="icon-java-duke"></i> interface, <i class="icon-python text-success"></i> duck typing
]

---
## <i class="icon-java-duke"></i>  interface, <i class="icon-python text-success"></i> duck typing


.left-split[

```java
interface Animal {
    void run();
}

class Dog implements Animal {
    @Override
    public void run() {
        System.out.println("wow");
    }
}

class Cat implements Animal {
    @Override
    public void run() {
        System.out.println("miao");
    }
}

Animal dog = new Dog();
Animal cat = new Cat();
dog.run();
cat.run()
```
]

.right-split[

```python
'''
class Animal(metaclass=ABCMeta):

    @abstractmethod
    def run(self):
        pass

class Dog(Animal):

    def run(self):
        print('wow')
'''

class Dog:

   def run():
       print('wow')

class Cat:

   def run():
       print('miao')


Dog().run()
Cat().run()

```
]

<button class="btn btn-raised" onclick="player.open('/src/interface.java', '/src/ducktype.py');">Eval</button>


---

## <i class="icon-go"></i> interface, duck typing: Example

.left-split[

```golang
// Animal interface
type Animal interface {
	Run()
}

// Dog
type Dog struct{}
func (d Dog) Run() { println("wow") }

// Cat
type Cat struct{}
func (c Cat) Run() { println("miao") }

// Runnable interface
type Runnable interface {
	Run()
}

type Show struct{}
func (s Show) Run() { println("show")}
type Update struct{}
func (u Update) Run() { println("update")}
```
]


.right-split[

```golang
func main() {
	println("-- Animal --")
	var animal Animal
	animal = new(Dog)
	animal.Run()
	animal = new(Cat)
	animal.Run()

	println("-- Runnable --")
	var run Runnable
	run = new(Show)
	run.Run()
	run = new(Update)
	run.Run()

	println("-- Duck Typing --")
	run = new(Dog)
	run.Run()
	animal = new(Show)
	animal.Run()
}
```

<button class="btn btn-raised" onclick="player.open('/src/interface_ducktype.go');">Eval</button>

]


---
## <i class="icon-go"></i> interface, duck typing: Summary

<span class="bg-info h1">Interface</span>

* å‘¼ã³å‡ºã—å´ã¸æ˜ç¤ºçš„ã«é–¢æ•°ã®å®šç¾©ã‚’å…¬é–‹ã§ãã‚‹
* å®Ÿè£…å¯¾è±¡ã®è²¬å‹™ç¯„å›²ã‚’æ˜ç¢ºã«ã§ãã‚‹

<span class="bg-info h1">DuckTyping</span>

* å‘¼ã³å‡ºã—å´ã¯å¯¾è±¡ãŒä½•ã«å¯¾ã—ã¦ã®ã‚‚ã®ã‹ï¼Ÿç†è§£ã™ã‚‹
* å®Ÿè£…å¯¾è±¡ã¯æ›–æ˜§ã«å®Ÿè£…ãŒå¯èƒ½

---
class: eye-bg

## <span class="bg-info">å°ã¾ã¨ã‚</span>

.h1[

* interface, duck typing ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‚ˆ
]


---
class: center, middle

.display-1[
éå»ã®

.en[Trend] ãªæ—… ç·¨
]

.title-img[![gopher](images/gophercolor.png)]


---
class: center, middle, eye-bg

.big[<span class="en">Linq / ReactiveX</span>]


---

## <span class="en">Linq (Language Integrated Query)</span>

ãƒ‡ãƒ¼ã‚¿ã«é›†åˆå¯¾ã—ã¦

* æ¨™æº–åŒ–ã—ãŸæ–¹å¼ã§è³­åˆã‚ã›ã‚’å¯èƒ½ã«ã—ãŸæŠ€è¡“
* è¨€èªãƒ¬ãƒ™ãƒ«ã§é«˜éšé–¢æ•°ã‚’åˆ©ç”¨ã—ã¦å•ã„åˆã‚ã›ã§ãã‚‹ã‚‚ã®

```csharp
  // Specify the data source.
  int[] scores = new int[] { 97, 92, 81, 60 };
  // Define the query expression.
  IEnumerable<int> scoreQuery =
      from score in scores
      where score > 80
      select score;
  // Execute the query.
  foreach (int i in scoreQuery) {
      Console.Write(i + " ");
  }
```


### <span class="en">References</span>

- [Wikipedia EN](https://en.wikipedia.org/wiki/Language_Integrated_Query) /  [Wikipedia JA](https://ja.wikipedia.org/wiki/%E7%B5%B1%E5%90%88%E8%A8%80%E8%AA%9E%E3%82%AF%E3%82%A8%E3%83%AA)
- [C# Programming concepts Language Integrated Query (LINQ)](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/concepts/linq/) <i class="fab fa-windows"></i>
- <a class="badge badge-pill badge-info" href="https://github.com/ahmetb/go-linq" target="_blank">go-linq godoc</a> / <a class="badge badge-pill badge-info" href="https://godoc.org/github.com/ahmetb/go-linq" target="_blank">github</a>

---
## <span class="en">Linq Java</span>

```java
// æ–‡å­—åˆ—Listã‚’ , ã§çµåˆã—ãŸæ–‡å­—åˆ—ã‚’è¿”ã™é–¢æ•°
Function<IntStream,String> join = (s) -> {
	return String.join(",",
					   s.mapToObj(Integer::toString)
					   .collect(Collectors.toList()));
};

// 1 .. 9 ã¾ã§ã®é…åˆ—
int[] data = IntStream.range(1, 10).toArray();

// stream ã®ä½œæˆ
IntStream linq = IntStream.of(data);

// å†…å®¹è¡¨ç¤ºï¼šé…åˆ—å†…å®¹ã‚’å…¨éƒ¨
System.out.println("data    : " + join.apply(linq));

// 4 ã‚ˆã‚Šå¤§ãã„æ•°å­—ã®ã¿ãƒ•ã‚£ãƒ«ã‚¿
linq = IntStream.of(data).filter(i -> i > 4);
// å†…å®¹è¡¨ç¤º
System.out.println("filtered: " + join.apply(linq));
```

<button class="btn btn-raised" onclick="player.open('/src/linq.java');">Eval</button>


---
## <span class="en">Linq Example</span>


go-linq ã‚’å…ƒã«ä½œæˆï¼ˆæ±ç”¨æ€§ã‚’æ¸›ã‚‰ã—ã¦ã‚³ãƒ”ãƒšï¼‰ã—ã¦ã¾ã™

.h3[
.lh16[

* query
   * ã‚¯ã‚¨ãƒªã‚’è¡¨ã™ã‚‚ã®
* from(data []int)
   * data ã‚’ã‚¯ã‚¨ãƒªã«å¤‰æ›
* selectBy()
   * ï¼‘ãƒ‡ãƒ¼ã‚¿ã¸ã®æ“ä½œ
* where()
   * æ¡ä»¶çµã‚Šè¾¼ã¿
* orderBy()
   * ã‚½ãƒ¼ãƒˆ
]]

---
## <span class="en">Linq Example</span>

.left-split[

```golang
// åå¾©ã‚’ç¹°ã‚Šè¿”ã™é–¢æ•°
type itr func() (int, bool)

// åå¾©å¯èƒ½ãªã‚¯ã‚¨ãƒª
type query struct {
	itr func() itr
}

// mapå¤‰æ›é–¢æ•°ã‚’å—ã‘ã¦å„è¦ç´ ã§é–¢æ•°å®Ÿè¡Œã®åå¾©ã‚’ç¹°ã‚Šè¿”ã™
func (q query) selectBy(mapFn func(int) int) query {
	return query{
		itr: func() itr {
			next := q.itr()
			return func() (int, bool) {
				ret, ok := next()
				if ok {
					ret = mapFn(ret)
				}
				return ret, ok
			}
		},
	}
}

```
]

.right-split[
```go
// []int ã‹ã‚‰ã‚¯ã‚¨ãƒªã‚’ä½œæˆã™ã‚‹
func from(data []int) query {
	len := len(data)
	return query{
        // å®Ÿè¡Œã™ã‚‹åº¦ã« index ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã—ã¦å€¤ã‚’è¿”ã™é–¢æ•°
		itr: func() itr {
			index := 0
			return func() (int, bool) {
				ok := index < len
				val := 0
				if ok {
					val = data[index]
					index++
				}
				return val, ok
			}
		},
	}
}
```
]

---
## <span class="en">Linq Example</span>

.left-split[
```go
// ãƒ•ã‚£ãƒ«ã‚¿é–¢æ•°ã§ãƒ•ã‚£ãƒ«ã‚¿ã—ã¦åå¾©ã‚’ç¹°ã‚Šè¿”ã™
func (q query) where(filter func(i int) bool) query {
	return query{
		itr: func() itr {
			next := q.itr()
			return func() (int, bool) {
				var (
					val int
					ok  bool
				)
				for val, ok = next(); ok; val, ok = next() {
					if filter(val) {
						return val, ok
					}
				}
				return val, ok
			}
		},
	}
}
```
]

.right-split[

```go
// ã‚½ãƒ¼ãƒˆã‚’è¡Œã†
func (q query) orderBy(less func(i, j int) bool) query {
	var nums []int
	q.apply(&nums)
	sort.Sort(sorter{nums: nums, less: less})
	return from(nums)
}

// ã‚½ãƒ¼ãƒˆç”¨
type nums []int
func (ns nums) Len() int      { return len(ns) }
func (ns nums) Swap(i, j int) { ns[i], ns[j] = ns[j], ns[i] }

type sorter struct {
	nums
	less func(i, j int) bool
}
func (s sorter) Less(i, j int) bool {
	return s.less(s.nums[i], s.nums[j])
}
```

]

---
## <span class="en">Linq Example</span>


.left-split[
<div class="text-center mermaid">
graph TD;
    start((data)) --> f1[selectBy next * 2];
    f1 --> f2[where next > 50];
    f2 --> odr[orderBy  sort DESC];
    odr --> fin((Finish));

    style start fill:#2cb5e8;
    style fin fill:#2cb5e8;
</div>
]

.right-split[

```go

func main() {
	data := []int{1, 10, 43, 28, 32, 5}
	var values []int
	from(data).apply(&values)
	fmt.Println("data: ", values)

	var selectValues []int
	from(data).selectBy(func(num int) int {
		return num * 2
	}).where(func(num int) bool {
		return num >= 50
	}).orderBy(func(i, j int) bool {
		// DESC
		return i > j
	}).apply(&selectValues)
	fmt.Println("select data: ", selectValues)
}
```

<button class="btn btn-raised" onclick="player.open('/src/linq.go');">Eval</button>

]

---
## <span class="en">Linq Summary</span>

<span class="bg-info h1"><i class="icon-go"></i>golang</span>

* è¨€èªæ¨™æº–ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã®å®Ÿè£…ã¯ç„¡ã„
* <code class="remark-inline-code inline-b">go get github.com/ahmetb/go-linq</code> ã§å–å¾—ã—ã¦ã¯åˆ©ç”¨å¯èƒ½
* .text-muted[å€‹äººçš„ã«Sliceã«ãã®æ©Ÿèƒ½ãŒã‚ã‚‹ã¨å¬‰ã—ã„]


---
## <span class="en">ReactiveX</span>

<div class="text-center mermaid">
graph LR;
    start((Start)) --> e1((Event1));
    e1((Event1)) --> e2((Event2));
    e2((Event2)) --> e3((Event3));
    e3((Event3)) --> fin((Finish));

    style start fill:#2cb5e8;
    style fin fill:#2cb5e8;
</div>


* .en[Observer, Iterator] ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ .en[Functional Programming] ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®


#### .en[References]

- .en[[ReactiveX](http://reactivex.io/)]
   - [ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–å®£è¨€](https://www.reactivemanifesto.org/ja)
- .en[[RxGo github](https://github.com/ReactiveX/RxGo)]

---
## .en[ReactiveX::RxJS]


```javascript
document.addEventListener('click', () => console.log('Clicked!'));
  â†“â†“â†“
import { fromEvent } from 'rxjs';

fromEvent(document, 'click').subscribe(() => console.log('Clicked!'));
```


```js
import { Observable } from 'rxjs';

const observable = new Observable(subscriber => {
  subscriber.next(1); subscriber.next(2); subscriber.next(3);
});

console.log('just before subscribe');
observable.subscribe({
  next(x) { console.log('got value ' + x); },
  error(err) { console.error('something wrong occurred: ' + err); },
  complete() { console.log('done'); }
});
console.log('just after subscribe');```

```bash
just before subscribe
got value 1
got value 2
got value 3
just after subscribe
done
```

---
## <span class="en">ReactiveX Exmaple</span>

.left-split[

```go
func main() {
	ticker := time.NewTicker(time.Second)
	defer ticker.Stop()
	value := make(chan bool)
	done := make(chan bool)

	go func() {
		defer func() { done <- true }()
		num := 0
		for {
			select {
			case <-value:
				num++
				if num >= 10 {
					return
				} else {
					fmt.Println("wait...[", num, "]")
				}
			}
		}
	}()
```
]

.right-split[
```go
	for {
		select {
		case <-done:
			fmt.Println("Done!")
			return
		case t := <-ticker.C:
			fmt.Println("Current time: ", t.Format("15:04:05"))
			value <- true
		}
	}
}
```
]

---
## <span class="en">ReactiveX Exmaple</span>

<div class="text-center mermaid">
graph LR;
    start((Event)) --> cb[Create Observable]
	cb --> s[Subscribe connect to observer];
	s --> fin((Continue));

    style start fill:#2cb5e8;
    style fin fill:#2cb5e8;
</div>

<div class="text-center mermaid">
graph LR;
	start((Continue)) --> ob{Observable Error?};
	ob --> |yes| do[Observer # onError]
	ob --> |no| no[Observer # onNext]
	do --> done[onCompleted];
	no --> done[onCompleted];
	done --> fin((End));

    style start fill:#2cb5e8;
    style fin fill:#2cb5e8;
</div>

1. Event ã‚½ãƒ¼ã‚¹ã‹ã‚‰ Observable ã‚’ä½œæˆã™ã‚‹
2. handler ã‹ã‚‰ Subscribe() ã§ Observer æ¥ç¶šã™ã‚‹


---
## <span class="en">ReactiveX Exmaple</span>

.left-split[

```go
type (
    // Event Handle funcs
	Next  func(interface{})
	Done  func()
	Error func(error)

	observable <-chan interface{}

	iterable <-chan interface{}
)

func (it iterable) Next() (interface{}, error) {
	if next, ok := <-it; ok {
		return next, nil
	}
	return nil, ErrEndOfInterator
}

// Event Handlers
type observer struct {
	next Next
	done Done
	err  Error
}
```
]

.right-split[

```go
// å…ƒã®ã‚³ãƒ¼ãƒ‰ã¯ onNext, onError, onCompleted ã‚„ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å¼•æ•°ã‹ã‚‰
// å†…éƒ¨ã§ observer ã‚’æ¥ç¶šã—ã¦ã„ã‚‹
func (o observable) subscribe(ob observer) chan subscription {
	done := make(chan subscription)
	sub := subscription{}
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘ã¦ã€ã‚¨ãƒ©ãƒ¼ã®å ´åˆã¯ onError, å€¤ã¯ onNext ã«é€šçŸ¥
	go func() {  // å…ƒã®ã‚³ãƒ¼ãƒ‰ã¯Optionã«å¿œã˜ã¦ã€concurent ã§å®Ÿè¡Œ
	OuterLoop:
		for item := range o {
			switch item := item.(type) {
			case error:
				ob.err(item)
				sub.Error = item
				break OuterLoop
			default:
				ob.next(item)
			}
		}

		if sub.Error == nil {
			ob.done()
		}
		done <- sub.End()
	}()
	return done
}
```
]

---
## <span class="en">ReactiveX Example</span>

.left-split[

```go
func just(items ...interface{}) observable {
	source := make(chan interface{})
	go func() {
		for _, item := range items {
			source <- item
		}
		close(source)
	}()

	return observable(source)
}
```

]

.right-split[

```go
func from(it iterable) observable {
	source := make(chan interface{})
	go func() {
		for {
			val, err := it.Next()
			if err != nil {
				break
			}
			source <- val
		}
		close(source)
	}()
	return observable(source)
}
```

]

---
## <span class="en">ReactiveX Example</span>


.left-split[

```go
func justSubscribe() {
	score := 0

	observer := handler(
		// next
		func(n interface{}) {
			if num, ok := n.(int); ok {
				score += num
			}
		},
		// done
		func() {
			score *= 2
		},
	)
	sub := just([]interface{}{1, 2, 3, 4, 5}).subscribe(observer)
	<-sub

	fmt.Println("score:", score)
	close(sub)
}
```
<button class="btn btn-raised" onclick="player.open('/src/rx.go');">Eval</button>

]

.right-split[

```go
func ticker() {
	score := 0
	observer := handler(/* same code */)
	value := make(chan interface{})
	itr, _ := toItr(value)
	sub := from(itr).subscribe(observer)
	defer close(sub)

	ticker := time.NewTicker(time.Second)
	go func() {
		defer ticker.Stop()
		num := 0
		for {
			select {
			case t := <-ticker.C:
				num++
				fmt.Println("Current time: ", t.Format("15:04:05"), ",num:", num)
				if num > 5 {
					close(value)
					return
				}
				value <- num
			}
		}
	}()
	<- sub
	fmt.Println("score:", score)
}
```

]


---
## <span class="en">ReactiveX Sumamry</span>

<span class="bg-info h1">Golang</span>

* <code class="remark-inline-code inline-b">go get -u github.com/reactivex/rxgo</code> ã§å–å¾—ã—ã¦ã¯åˆ©ç”¨å¯èƒ½
* .text-danger[This is an early project and your contributions will help shape its direction.] ãªã®ã§æ³¨æ„

<span class="bg-info h1">ReactiveX(FRP)</span>

* ã„ã‚ã„ã‚å¤§å¤‰ï¼ˆæ¦‚å¿µç†è§£ã—ãŸã‚Šã€å®Ÿè£…åŠ›ã‚ã’ãŸã‚Šï¼‰
* å…¨ã¦ã‚’ã‚¹ãƒˆãƒªãƒ¼ãƒ ã¨è¦‹ãŸã‚Š...
.text-center[
<image src="images/everything-is-stream.jpg" width="20%" />
]

---
class: center, middle, eye-bg

.display-1[
æ—…ã®çµ‚ã‚ã‚Š

ã¾ã¨ã‚
]

---

## æ—…ã®ã¾ã¨ã‚

<span class="bg-info h1">Golang ã®æ—…</span>

* ç°¡æ½”ã«æ›¸ã

<span class="bg-info h1">Lang ãªæ—…</span>

* SubClass ã‚’æŒãŸãªã„
* block å¤‰æ•°ã¨ã‹ç‰¹æ®Šãªå¤‰æ•°ã‚„ãã®è¨˜è¿°ã¯ãªã„
* async, await ã¯ã‚µãƒãƒ¼ãƒˆã—ãªã„
* annotation, decorator ã¯ã‚µãƒãƒ¼ãƒˆã—ãªã„  
  â†’ StructTagã‚’ã‚µãƒãƒ¼ãƒˆ <i class="icon-go"></i>
* interface, duck typing ã‚’ã‚µãƒãƒ¼ãƒˆ <i class="icon-go"></i>

<span class="bg-info h1">Trend ãªæ—…</span>

* ç°¡å˜ã«æ›¸ã‘ã‚‹ã‚ˆ
* ä½¿ã†ã‹ã¯ãƒ»ãƒ»ãƒ»ã‚ãªãŸæ¬¡ç¬¬ãƒ»ãƒ»ãƒ»


---
class: center, middle

.h1[
ã‚µãƒãƒ¼ãƒˆæ©Ÿèƒ½å°‘ãªã„

ã‘ã©ç°¡å˜ã«ã‹ã‘ã‚‹
]

.big[
ãªã‚“ã§ã‹ï¼Ÿ
]

---

## ã¾ã¨ã‚ ã¨ .en[Features in Go] <i class="icon-go"></i>

<div class="card">

<div class="card-body bg-light border-rounded">

<div class="h2">
<p>Go ã¯é•ã†ã‚‚ã®ã§ã™</p>
<p class="text-muted">Go is different.</p>
<br>
<p>ä»–ã®è¨€èªã®ã‚ˆã†ã«ã«ã¯ãªã‚‰ãªã„ã‚ˆ</p>
<p class="text-muted">Go does not try to be like the other languages.</p>
<br>
<p>æ©Ÿèƒ½ã‚’ç«¶ã‚ãªã„ã‚ˆ</p>
<p class="text-muted">Go does not compete on features.</p>
</div>
</div>

</div>

<br/>

.text-center[
.en[by Rob Pike]
]

---

## æ—…ã®ã¾ã¨ã‚ ã‹ã‚‰ã¿ã‚‹ Goã®æ©Ÿèƒ½

.left-split[

<span class="bg-info h1">Golang ã®æ—…</span>

* ç°¡æ½”ã«æ›¸ã

<span class="bg-info h1">Lang ãªæ—…</span>

* SubClass ã‚’æŒãŸãªã„
* block å¤‰æ•°ã¨ã‹ç‰¹æ®Šãªå¤‰æ•°ã‚„ãã®è¨˜è¿°ã¯ãªã„
* async, await ã¯ã‚µãƒãƒ¼ãƒˆã—ãªã„
* annotation, decorator ã¯ã‚µãƒãƒ¼ãƒˆã—ãªã„  
  â†’ StructTagã‚’ã‚µãƒãƒ¼ãƒˆ <i class="icon-go"></i>
* interface, duck typing ã‚’ã‚µãƒãƒ¼ãƒˆ <i class="icon-go"></i>

<span class="bg-info h1">Trend ãªæ—…</span>

* ç°¡å˜ã«æ›¸ã‘ã‚‹ã‚ˆ
* ä½¿ã†ã‹ã¯ãƒ»ãƒ»ãƒ»ã‚ãªãŸæ¬¡ç¬¬ãƒ»ãƒ»ãƒ»

]

.right-split[

.h2[
<span class="bg-warning text-white h1">ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ</span>

* è¨€èªæ©Ÿèƒ½ãŒå¢—åŠ ã™ã‚‹ã¨è¦šãˆã‚‹ãƒ»ã™ã‚‹ã“ã¨ã‚‚å¢—åŠ 
   * ä¿å®ˆæ€§ã€å¯èª­æ€§ã®æ¸›å°‘

<br><br>

<span class="bg-primary text-white h1">ã‚„ã‚ŠãŸã„ã“ã¨</span>

* ã‚‚ã®ã‚’ä½œã£ãŸã‚Šã€å•é¡Œã‚’è§£æ±ºã—ãŸã‚Šã—ãŸã„
* Trendã®å–ã‚Šè¾¼ã¿ã‚„æŠ€æ³•ã®ä½¿ã„ãŸã„

<br><br>

<span class="bg-danger text-white h1">ãƒ¢ãƒãƒ™ãƒ»æ€æƒ³ãƒ»å“²å­¦</span>

* What???

]

]

---

## ã¾ã¨ã‚

<div class="text-center display-2">
<span class="bg-info pl-4 pr-4 pt-1 pb-1 en">
Simplicity
</span>
</div>

<br>

.en[
.text-center[
Go is simple, at least compared to established languages.

Simplicity has many facets.
]]

<br>

<div class="text-center display-2">
<span class="bg-info pl-4 pr-4 pt-1 pb-1 en">
Simplicity is Complicated
</span>
</div>

.text-center[
<a class="badge badge-pill badge-info" href="https://talks.golang.org/2015/simplicity-is-complicated.slide#1" target="_blank">
Simplicity is Complicated <i class="inline-b material-icons" style="display: inline-flex; vertical-align: middle;">exit_to_app</i>
</a>

<small class="en">by Rob Pike</small>
]

---
class: center, eye-bg


.display-2[

<br>

Go code that is

- simple,
- readable,
- maintainable.
]

---
class: center, eye-bg

<br>

.display-2[
<p class="pt-3 pb-3 bubble" style="line-height: 1.6em;">
<i class="icon-python text-success"></i>
<i class="icon-java-duke"></i>
<i class="icon-ruby text-danger"></i>
<i class="icon-javascript-alt" style="color:gold;"></i>
<i class="icon-csharp text-success"></i>
<i class="icon-go text-info"></i>
<br>
å„è¨€èªãƒ‡ã‚£ã‚¹ã£ã¦ã„ã‚‹<br>
å†…å®¹ã‚ã‚Œã°ã™ã¿ã¾ã›ã‚“

</p>
]

---
class: center, middle, eye-bg

.display-2[
<p class="pt-3 pb-3 bubble" style="line-height: 1.6em;">
ã”é™è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ
</p>
]

---

## .en[Simplicity] ã¨ .en[Generics]

.en[Declaration]

```go
type List(type T) []T

func Keys(type K, V)(m map[K]V) []K
```

.en[Uses]

```go
var ints List(int)

keys := Keys(int, string)(map[int]string{1:"one", 2: "two"})
```

.text-right[
<a class="badge badge-pill badge-info" href="https://go.googlesource.com/proposal/+/master/design/go2draft-generics-overview.md" target="_blank">
Generics â€” Problem Overview <i class="inline-b material-icons" style="display: inline-flex; vertical-align: middle;">exit_to_app</i>
</a>
]

.left-split[
* å€‹äººçš„ãªæ°—æŒã¡ã§ã¯å¬‰ã—ã„
* Simplicity ã‚’å´©ã—ã¦ã—ã¾ã†ã®ã§ã¯ç„¡ã„ã‹ï¼Ÿã¨ã¡ã‚‡ã£ã¨å¿ƒé…ã—ã¦ã„ã¾ã™
]

.right-split[
<img src="images/mic-drop.png" width="40%">
]


---
## ä½™è«‡

.text-center[
.display-3[
<p class="pt-3 pb-3 bubble" style="line-height: 1.6em;">
ã‚‚ã®ã”ã¨ã¯ãƒãƒ¼ãƒˆã§è¦‹ãªãã¡ã‚ƒã„ã‘ãªã„ã€<br/>

ã£ã¦ã„ã†ã“ã¨ãªã‚“ã ã€‚<br/>

å¤§åˆ‡ãªã“ã¨ã¯ã€ç›®ã«è¦‹ãˆãªã„ã‹ã‚‰ã­
</p>
]

<br/>

**å¼•ç”¨:** _æ˜Ÿã®ç‹å­æ§˜_
]
